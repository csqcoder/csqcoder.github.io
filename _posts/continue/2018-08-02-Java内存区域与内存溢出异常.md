---
layout: post
title: Java内存区域与内存溢出异常
categories: JVM
description: JVM
keywords: Java, JVM
---
## Java内存区域与内存溢出异常
### 运行时数据区域
```
方法区，
虚拟机栈，
本地方法栈，
堆，
程序计数器
```

#### 所有线程共享的数据区
方法区，堆

#### 线程隔离的数据区
虚拟机栈，本地方法栈，程序计数器

#### 程序计数器
```
保存下一条指令的所在存储单元地址
```
程序计数器，占用较小的内存空间。在当前线程中，字节码解释器通过计数器的值来选去下一条需要执行的字节码指令，分支，循环，跳转，异常处理，线程恢复等基础功能都需要依赖这个计数器来完成。

同时程序计数器保证了，在多线程情况下，每个线程执行完毕之后能够回到正确的执行位置，每个线程都有一个独立的程序计数器且互不影响，独立存储。

如果线程执行的是一个 Java 方法，这个计数器记录的是一个正在执行的虚拟机字节码指令地址；如果执行的是 Native 方法，这个计数器则为空（Undefined）。此内存区域是唯一一个在 Java 虚拟机规范中没有规定任何 OutOfMemoryError 情况的区域。

#### Java 虚拟机栈

Java 虚拟机栈的生命周期与线程相同，并且是线程私有的。虚拟机栈描述的是 Java 方法执行的内存模型，每个放在在执行的时候都会去创建一个栈帧，用于存储局部变量表，操作数栈，动态链接，方法出口信息等。每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈和出栈的过程。
局部变量表存放了编译期可知的各种数据类型（boolean, byte, char, short, int, float, long, double），对象引用和 returnAdress类型（指向）。

在Java虚拟机栈，对这个区域规定了两种异常状况：如果线程请求的栈深度大于虚拟机所允许的深度，将抛出 StackOverflowError 异常；如果虚拟机栈可以动态的扩展，如果无法申请到足够的内存，就会抛出 OutOfMemoryError 异常。







